<?php
/**
 * WordPress Configuration Template
 *
 * Values are populated from environment variables at container startup.
 * Do NOT commit actual secrets to version control.
 */

// ---------------------------------------------------------------------------
// Database settings
// ---------------------------------------------------------------------------
define( 'DB_NAME',     getenv( 'WORDPRESS_DB_NAME' )     ?: 'wordpress' );
define( 'DB_USER',     getenv( 'WORDPRESS_DB_USER' )     ?: 'wordpress' );
define( 'DB_PASSWORD', getenv( 'WORDPRESS_DB_PASSWORD' ) ?: '' );
define( 'DB_HOST',     getenv( 'WORDPRESS_DB_HOST' )     ?: 'db' );
define( 'DB_CHARSET',  'utf8mb4' );
define( 'DB_COLLATE',  '' );

// ---------------------------------------------------------------------------
// Authentication keys and salts
// Generate fresh values at: https://api.wordpress.org/secret-key/1.1/salt/
// ---------------------------------------------------------------------------
define( 'AUTH_KEY',         getenv( 'WP_AUTH_KEY' )         ?: 'put your unique phrase here' );
define( 'SECURE_AUTH_KEY',  getenv( 'WP_SECURE_AUTH_KEY' )  ?: 'put your unique phrase here' );
define( 'LOGGED_IN_KEY',    getenv( 'WP_LOGGED_IN_KEY' )    ?: 'put your unique phrase here' );
define( 'NONCE_KEY',        getenv( 'WP_NONCE_KEY' )        ?: 'put your unique phrase here' );
define( 'AUTH_SALT',        getenv( 'WP_AUTH_SALT' )        ?: 'put your unique phrase here' );
define( 'SECURE_AUTH_SALT', getenv( 'WP_SECURE_AUTH_SALT' ) ?: 'put your unique phrase here' );
define( 'LOGGED_IN_SALT',   getenv( 'WP_LOGGED_IN_SALT' )   ?: 'put your unique phrase here' );
define( 'NONCE_SALT',       getenv( 'WP_NONCE_SALT' )       ?: 'put your unique phrase here' );

// ---------------------------------------------------------------------------
// Cache settings
// ---------------------------------------------------------------------------
define( 'WP_CACHE', true );

/** Redis object cache */
define( 'WP_REDIS_HOST',    getenv( 'REDIS_HOST' )    ?: 'redis' );
define( 'WP_REDIS_PORT',    (int) ( getenv( 'REDIS_PORT' ) ?: 6379 ) );
define( 'WP_REDIS_TIMEOUT', 1 );
define( 'WP_REDIS_PREFIX',  'wp_' );

// ---------------------------------------------------------------------------
// AI WP Dynamic Cache plugin settings
// ---------------------------------------------------------------------------
define( 'AI_WP_CACHE_WORKER_URL',  getenv( 'WORKER_URL' )   ?: '' );
define( 'AI_WP_CACHE_HMAC_SECRET', getenv( 'HMAC_SECRET' )  ?: '' );

// ---------------------------------------------------------------------------
// Debug settings
// ---------------------------------------------------------------------------
define( 'WP_DEBUG',         getenv( 'WP_DEBUG' ) === 'true' );
define( 'WP_DEBUG_LOG',     getenv( 'WP_DEBUG' ) === 'true' );
define( 'WP_DEBUG_DISPLAY', false );
define( 'SCRIPT_DEBUG',     getenv( 'WP_DEBUG' ) === 'true' );

// ---------------------------------------------------------------------------
// Performance
// ---------------------------------------------------------------------------
define( 'WP_MEMORY_LIMIT',     '256M' );
define( 'WP_MAX_MEMORY_LIMIT', '512M' );
define( 'CONCATENATE_SCRIPTS', false );

// ---------------------------------------------------------------------------
// URLs (set these when running behind a reverse proxy)
// ---------------------------------------------------------------------------
if ( getenv( 'WP_HOME' ) ) {
    define( 'WP_HOME',    getenv( 'WP_HOME' ) );
    define( 'WP_SITEURL', getenv( 'WP_HOME' ) );
}

// ---------------------------------------------------------------------------
// Table prefix
// ---------------------------------------------------------------------------
$table_prefix = getenv( 'WORDPRESS_TABLE_PREFIX' ) ?: 'wp_';

// ---------------------------------------------------------------------------
// Absolute path to WordPress directory
// ---------------------------------------------------------------------------
if ( ! defined( 'ABSPATH' ) ) {
    define( 'ABSPATH', __DIR__ . '/' );
}

require_once ABSPATH . 'wp-settings.php';
